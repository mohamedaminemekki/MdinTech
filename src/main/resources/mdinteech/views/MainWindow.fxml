<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.shape.Rectangle?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.effect.InnerShadow?>
<?import javafx.scene.paint.LinearGradient?>
<?import javafx.scene.paint.Stop?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.text.FontWeight?>

<BorderPane xmlns:fx="http://javafx.com/fxml" fx:controller="mdinteech.controllers.MainController">

    <!-- Menu latéral avec icônes -->
    <left>
        <VBox spacing="20" style="-fx-background-color: #2C3E50; -fx-padding: 25px; -fx-border-radius: 15px; -fx-effect: dropshadow(gaussian, rgba(0, 0, 0, 0.3), 5, 2, 0, 5);">
            <Label text="Mdintech" style="-fx-text-fill: #ECF0F1; -fx-font-size: 24px; -fx-font-family: 'Montserrat'; -fx-font-weight: bold;"/>
            <Button text="🏠 Accueil" onAction="#goToHome" style="-fx-background-color: transparent; -fx-text-fill: #ECF0F1; -fx-font-size: 16px; -fx-padding: 12px 20px; -fx-background-radius: 8px; -fx-border-color: transparent; -fx-cursor: hand;"/>
            <Button text="📜 Réserver" onAction="#handleReserve" style="-fx-background-color: transparent; -fx-text-fill: #ECF0F1; -fx-font-size: 16px; -fx-padding: 12px 20px; -fx-background-radius: 8px; -fx-border-color: transparent; -fx-cursor: hand;"/>
            <Button text="📝 Mes réservations" onAction="#showReservations" style="-fx-background-color: transparent; -fx-text-fill: #ECF0F1; -fx-font-size: 16px; -fx-padding: 12px 20px; -fx-background-radius: 8px; -fx-border-color: transparent; -fx-cursor: hand;"/>
            <Button text="📞 Support" onAction="#contactSupport" style="-fx-background-color: transparent; -fx-text-fill: #ECF0F1; -fx-font-size: 16px; -fx-padding: 12px 20px; -fx-background-radius: 8px; -fx-border-color: transparent; -fx-cursor: hand;"/>
            <Button text="🚆 Carte Train" onAction="#openTrainMap" style="-fx-background-color: transparent; -fx-text-fill: #ECF0F1; -fx-font-size: 16px; -fx-padding: 12px 20px; -fx-background-radius: 8px; -fx-border-color: transparent; -fx-cursor: hand;"/>
            <Button text="🚌 Carte Bus" onAction="#openBusMap" style="-fx-background-color: transparent; -fx-text-fill: #ECF0F1; -fx-font-size: 16px; -fx-padding: 12px 20px; -fx-background-radius: 8px; -fx-border-color: transparent; -fx-cursor: hand;"/>
            <Button text="🚇 Carte Métro" onAction="#openMetroMap" style="-fx-background-color: transparent; -fx-text-fill: #ECF0F1; -fx-font-size: 16px; -fx-padding: 12px 20px; -fx-background-radius: 8px; -fx-border-color: transparent; -fx-cursor: hand;"/>
        </VBox>
    </left>

    <!-- Contenu principal -->
    <center>
        <ScrollPane fitToWidth="true" fitToHeight="true" style="-fx-background: transparent; -fx-background-color: transparent;">
            <VBox spacing="20" alignment="CENTER" style="-fx-padding: 30px; -fx-background-color: #F5F6F7;">

                <!-- Barre supérieure avec message de bienvenue -->
                <HBox spacing="12" alignment="CENTER" style="-fx-padding: 10px; -fx-background-color: #2C3E50; -fx-background-radius: 10px;">
                    <Label text="🚀 Bienvenue sur Mdintech ! Trouvez et réservez votre transport en un clic ! 🚌🚆  !" style="-fx-text-fill: #ECF0F1; -fx-font-size: 24px; -fx-font-family: 'Montserrat'; -fx-font-weight: bold;"/>
                    <Region fx:id="spacer" HBox.hgrow="ALWAYS"/>
                    <Button text="👤 Profil" onAction="#handleProfile" style="-fx-background-color: #2C3E50; -fx-text-fill: #ECF0F1; -fx-font-size: 14px; -fx-padding: 8px 12px; -fx-background-radius: 8px; -fx-cursor: hand;"/>
                </HBox>

                <!-- Bannière promotions avec icône et couleur -->
                <HBox alignment="CENTER" style="-fx-background-color: #07914f; -fx-padding: 15px; -fx-background-radius: 10px;">
                    <Label text="🎉 Promotion spéciale : -20% sur les trajets entre Tunis et Sousse !" style="-fx-text-fill: white; -fx-font-size: 18px;"/>
                </HBox>

                <!-- Barre de recherche -->
                <HBox spacing="12" alignment="CENTER" style="-fx-padding: 15px; -fx-background-color: #FFFFFF; -fx-background-radius: 10px; -fx-effect: dropshadow(gaussian, rgba(0, 0, 0, 0.1), 5, 3, 0, 5);">
                    <ComboBox fx:id="departureField" promptText="Départ" style="-fx-font-size: 14px; -fx-background-color: #ffffff; -fx-border-radius: 8px; -fx-border-color: #BDC3C7; -fx-padding: 5px 10px;"/>
                    <ComboBox fx:id="destinationField" promptText="Destination" style="-fx-font-size: 14px; -fx-background-color: #ffffff; -fx-border-radius: 8px; -fx-border-color: #BDC3C7; -fx-padding: 5px 10px;"/>
                    <DatePicker fx:id="dateField" promptText="Date" style="-fx-font-size: 14px; -fx-background-color: #ffffff; -fx-border-radius: 8px; -fx-border-color: #BDC3C7; -fx-padding: 5px 10px;"/>
                    <TextField fx:id="priceField" promptText="Prix Max (DT)" style="-fx-font-size: 14px; -fx-background-color: #ffffff; -fx-border-radius: 8px; -fx-border-color: #BDC3C7; -fx-padding: 5px 10px;"/>
                    <Button text="🔍 Rechercher" onAction="#quickSearch" style="-fx-background-color: #2C3E50; -fx-text-fill: white; -fx-font-size: 16px; -fx-padding: 10px 20px; -fx-background-radius: 8px; -fx-cursor: hand;"/>
                    <Button text="✖ Effacer" onAction="#clearSearch" style="-fx-background-color: #E74C3C; -fx-text-fill: white; -fx-font-size: 16px; -fx-padding: 10px 20px; -fx-background-radius: 8px; -fx-cursor: hand;"/>
                </HBox>

                <!-- Slider d'images -->
                <StackPane alignment="CENTER" style="-fx-background-radius: 15px;">
                    <ImageView fx:id="sliderImage" fitHeight="200" fitWidth="600" style="-fx-background-radius: 15px; -fx-effect: dropshadow(gaussian, rgba(0, 0, 0, 0.3), 5, 3, 0, 5);"/>
                    <Rectangle width="600" height="200" arcWidth="15" arcHeight="15" fill="transparent" stroke="#2C3E50" strokeWidth="2"/>
                </StackPane>

                <!-- ListView des trajets sous les images -->
                <ListView fx:id="tripListView" prefWidth="920" prefHeight="270" style="-fx-background-color: #193b59; -fx-border-radius: 10px; -fx-effect: dropshadow(gaussian, rgba(0, 0, 0, 0.1), 5, 3, 0, 5);"/>

                <!-- Panneau d’information dynamique -->
                <VBox fx:id="infoPanel" spacing="12" alignment="CENTER" style="-fx-padding: 20px; -fx-background-color: #ECF0F1; -fx-border-radius: 10px;">
                    <Label fx:id="infoLabel" text="Détails du trajet sélectionné" style="-fx-font-size: 18px; -fx-text-fill: #2C3E50;"/>
                </VBox>

                <!-- Bouton "Réserver" -->
                <Button fx:id="reserveButton" text="🎟️ Réservez maintenant" onAction="#handleReserve"
                        style="-fx-background-color: #2C3E50; -fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold; -fx-padding: 12px 20px; -fx-background-radius: 10px; -fx-cursor: hand;" disable="true"/>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane>